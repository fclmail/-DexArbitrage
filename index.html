<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Manual Crypto Trading</title>
    <script src="https://cdn.ethers.io/lib/ethers-5.6.umd.min.js" type="application/javascript"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #222;
            color: #fff;
            margin: 0;
            padding: 20px;
        }

        input, button {
            padding: 10px;
            margin: 10px 0;
            font-size: 16px;
        }

        button {
            background-color: #28a745;
            color: #fff;
            border: none;
            cursor: pointer;
        }

        button.sell {
            background-color: #dc3545;
        }
    </style>
</head>

<body>
    <h1>Manual Crypto Trading</h1>
    <p>Connect your MetaMask wallet and manually trade tokens.</p>
    <button id="connectWallet">Connect MetaMask</button>
    <p id="walletStatus">Wallet: Not connected</p>

    <h2>Trade Tokens</h2>
    <label for="tokenAddress">Token Address:</label>
    <input type="text" id="tokenAddress" placeholder="ERC-20 Token Address">

    <label for="amount">Amount:</label>
    <input type="number" id="amount" placeholder="Amount to trade">

    <button id="buyToken">Buy Token</button>
    <button id="sellToken" class="sell">Sell Token</button>

    <p id="transactionStatus"></p>

    <script>
        let provider, signer;

        // Connect MetaMask
        document.getElementById('connectWallet').addEventListener('click', async () => {
            if (window.ethereum) {
                try {
                    await ethereum.request({ method: 'eth_requestAccounts' });
                    provider = new ethers.providers.Web3Provider(window.ethereum);
                    signer = provider.getSigner();
                    const address = await signer.getAddress();
                    document.getElementById('walletStatus').textContent = `Wallet: ${address}`;
                } catch (err) {
                    alert('Failed to connect MetaMask: ' + err.message);
                }
            } else {
                alert('MetaMask is not installed!');
            }
        });

        // Buy Token
        document.getElementById('buyToken').addEventListener('click', async () => {
            const tokenAddress = document.getElementById('tokenAddress').value;
            const amount = document.getElementById('amount').value;

            if (!tokenAddress || !amount) {
                alert('Please enter token address and amount.');
                return;
            }

            try {
                const tokenContract = new ethers.Contract(
                    tokenAddress,
                    [
                        "function transfer(address to, uint256 value) public returns (bool)",
                        "function approve(address spender, uint256 value) public returns (bool)"
                    ],
                    signer
                );

                const transaction = await tokenContract.transfer(
                    '0xYourReceiverAddressHere', // Replace with receiver (DEX Router or wallet)
                    ethers.utils.parseUnits(amount, 18)
                );

                await transaction.wait();
                document.getElementById('transactionStatus').textContent = `Transaction successful! Tx Hash: ${transaction.hash}`;
            } catch (err) {
                console.error(err);
                document.getElementById('transactionStatus').textContent = `Transaction failed: ${err.message}`;
            }
        });

        // Sell Token
        document.getElementById('sellToken').addEventListener('click', async () => {
            const tokenAddress = document.getElementById('tokenAddress').value;
            const amount = document.getElementById('amount').value;

            if (!tokenAddress || !amount) {
                alert('Please enter token address and amount.');
                return;
            }

            try {
                const tokenContract = new ethers.Contract(
                    tokenAddress,
                    [
                        "function transferFrom(address from, address to, uint256 value) public returns (bool)",
                        "function approve(address spender, uint256 value) public returns (bool)"
                    ],
                    signer
                );

                // Approve tokens to the recipient (e.g., DEX or other contract)
                const approval = await tokenContract.approve(
                    '0xYourReceiverAddressHere', // Replace with DEX/router address
                    ethers.utils.parseUnits(amount, 18)
                );
                await approval.wait();

                // Sell tokens (you may implement further logic for this in a contract)
                const transaction = await tokenContract.transferFrom(
                    await signer.getAddress(),
                    '0xYourReceiverAddressHere', // Replace with DEX/router address
                    ethers.utils.parseUnits(amount, 18)
                );

                await transaction.wait();
                document.getElementById('transactionStatus').textContent = `Tokens sold successfully! Tx Hash: ${transaction.hash}`;
            } catch (err) {
                console.error(err);
                document.getElementById('transactionStatus').textContent = `Transaction failed: ${err.message}`;
            }
        });
    </script>
</body>

</html> 
